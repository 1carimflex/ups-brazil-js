!function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory(require("axios"),require("xml"),require("xml2js")):"function"==typeof define&&define.amd?define(["axios","xml","xml2js"],factory):(global=global||self).UPSBrazil=factory(global.axios,global.xml,global.xml2js)}(this,(function(axios,xml,xml2js){"use strict";function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}axios=axios&&Object.prototype.hasOwnProperty.call(axios,"default")?axios.default:axios,xml=xml&&Object.prototype.hasOwnProperty.call(xml,"default")?xml.default:xml;class UPSBrazilFetchServerError extends Error{constructor(status){super("Server error status ".concat(status," ")),this.name="UPSBrazilFetchServerError"}}class UPSBrazilFetchClientError extends Error{constructor(){super("Client error"),this.name="UPSBrazilFetchClientError"}}class UPSBrazilFetchOtherError extends Error{constructor(){super("Other Error"),this.name="UPSBrazilFetchOtherError"}}var URL_ENDPOINT="https://www.ups.com.br/upsbilling/UPS_Billing.asmx";function _ref(){return(_ref=_asyncToGenerator((function*(user,password,originZipCode,destinationZipCode,packageData,invoiceValue){var timeout=arguments.length>6&&void 0!==arguments[6]?arguments[6]:5e3,data=[{nr_peso:packageData.weight},{nr_conta:user},{nr_cep_origem:originZipCode.match(/\d+/g).join("")},{nr_cep_destino:destinationZipCode.match(/\d+/g).join("")},{vl_valor_mercadoria:invoiceValue},{nr_quantidade_pacotes:1},{nm_cidade_origem:""},{nm_cidade_destino:""},{ds_dimencional:"".concat(Math.round(packageData.height),"/").concat(Math.round(packageData.width),"/").concat(Math.round(packageData.length))},{autenticacao:[{nr_conta:user},{nr_chaveAcesso:password}]}],xmlString=xml([{"soap:Envelope":[{_attr:{"xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:soap":"http://schemas.xmlsoap.org/soap/envelope/"}},{"soap:Body":[{UPS_Retorno_Frete:[{_attr:{xmlns:"http://tempuri.org/"}},{ParametroFrete:data}]}]}]}],{declaration:!0}),headers={SOAPAction:"http://tempuri.org/UPS_Retorno_Frete","Content-Type":"text/xml; charset=utf-8"},params={url:URL_ENDPOINT,method:"POST",timeout:timeout,headers:headers,data:xmlString};try{var{data:dataResponse}=yield axios(params),parsedData=yield xml2js.parseStringPromise(dataResponse),innerData=parsedData["soap:Envelope"]["soap:Body"][0].UPS_Retorno_FreteResponse[0].UPS_Retorno_FreteResult[0]["diffgr:diffgram"][0].NewDataSet[0].Table[0];return{CustoReais:parseInt(innerData.CustoReais[0],10),ValorDesconto:parseInt(innerData.ValorDesconto[0],10),ValorSeguro:parseInt(innerData.ValorSeguro[0],10),ValorSeguro1:parseInt(innerData.ValorSeguro1[0],10),ValorFrete:parseInt(innerData.ValorFrete[0],10),ValorFreteComSeguro:parseInt(innerData.ValorFreteComSeguro[0],10),ValorEA:parseInt(innerData.ValorEA[0],10),FreteTotalReceber:parseInt(innerData.FreteTotalReceber[0],10),CentroDestino:parseInt(innerData.CentroDestino[0],10),ValorAR:parseInt(innerData.ValorAR[0],10),AcessoSistema:innerData.AcessoSistema[0],RetornoAreaRisco:"S"===innerData.RetornoAreaRisco[0],FreteSemImposto:parseInt(innerData.FreteSemImposto[0],10),ValorIcms:parseInt(innerData.ValorIcms[0],10),ValorPisCofins:parseInt(innerData.ValorPisCofins[0],10),TaxaDomestico:parseInt(innerData.TaxaDomestico[0],10)}}catch(error){throw error.response?new UPSBrazilFetchServerError(error.response.status):error.request?new UPSBrazilFetchClientError:new UPSBrazilFetchOtherError}}))).apply(this,arguments)}return function(_x,_x2,_x3,_x4,_x5,_x6){return _ref.apply(this,arguments)}}));